import sympy as sp
import Compiler.mpc_math
from gfapp import GFA
from ml import sigmoid

sfix.set_precision(31, 63)

# target function.
@GFA(10, 31, 63, (-10,10))
def mysigmoid(x):
    return 1 / ((1 + sp.exp(-x)))

print_ln('using GFA sigmoid')
for i in range(-2, 2):
    actual = mysigmoid(sfix(i))
    expected = sigmoid(sfix(i))
    print_ln('expected %s, got %s', expected.reveal(), actual.reveal())

